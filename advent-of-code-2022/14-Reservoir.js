const input = `541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n528,67 -> 533,67\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,16 -> 498,23 -> 500,23 -> 500,17 -> 500,23 -> 502,23 -> 502,16 -> 502,23\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n514,62 -> 519,62\n509,56 -> 514,56\n497,36 -> 497,30 -> 497,36 -> 499,36 -> 499,27 -> 499,36 -> 501,36 -> 501,33 -> 501,36 -> 503,36 -> 503,27 -> 503,36 -> 505,36 -> 505,28 -> 505,36 -> 507,36 -> 507,35 -> 507,36\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n574,133 -> 574,137 -> 567,137 -> 567,141 -> 584,141 -> 584,137 -> 576,137 -> 576,133\n524,60 -> 529,60\n574,133 -> 574,137 -> 567,137 -> 567,141 -> 584,141 -> 584,137 -> 576,137 -> 576,133\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n506,39 -> 506,43 -> 499,43 -> 499,51 -> 514,51 -> 514,43 -> 510,43 -> 510,39\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n503,60 -> 508,60\n567,115 -> 571,115\n556,151 -> 556,153 -> 548,153 -> 548,157 -> 561,157 -> 561,153 -> 560,153 -> 560,151\n497,36 -> 497,30 -> 497,36 -> 499,36 -> 499,27 -> 499,36 -> 501,36 -> 501,33 -> 501,36 -> 503,36 -> 503,27 -> 503,36 -> 505,36 -> 505,28 -> 505,36 -> 507,36 -> 507,35 -> 507,36\n525,69 -> 530,69\n557,83 -> 557,85 -> 550,85 -> 550,89 -> 569,89 -> 569,85 -> 561,85 -> 561,83\n574,133 -> 574,137 -> 567,137 -> 567,141 -> 584,141 -> 584,137 -> 576,137 -> 576,133\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,16 -> 498,23 -> 500,23 -> 500,17 -> 500,23 -> 502,23 -> 502,16 -> 502,23\n564,108 -> 564,107 -> 564,108 -> 566,108 -> 566,101 -> 566,108 -> 568,108 -> 568,100 -> 568,108\n496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,16 -> 498,23 -> 500,23 -> 500,17 -> 500,23 -> 502,23 -> 502,16 -> 502,23\n556,151 -> 556,153 -> 548,153 -> 548,157 -> 561,157 -> 561,153 -> 560,153 -> 560,151\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n497,36 -> 497,30 -> 497,36 -> 499,36 -> 499,27 -> 499,36 -> 501,36 -> 501,33 -> 501,36 -> 503,36 -> 503,27 -> 503,36 -> 505,36 -> 505,28 -> 505,36 -> 507,36 -> 507,35 -> 507,36\n556,151 -> 556,153 -> 548,153 -> 548,157 -> 561,157 -> 561,153 -> 560,153 -> 560,151\n561,115 -> 565,115\n564,144 -> 568,144\n497,36 -> 497,30 -> 497,36 -> 499,36 -> 499,27 -> 499,36 -> 501,36 -> 501,33 -> 501,36 -> 503,36 -> 503,27 -> 503,36 -> 505,36 -> 505,28 -> 505,36 -> 507,36 -> 507,35 -> 507,36\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n497,36 -> 497,30 -> 497,36 -> 499,36 -> 499,27 -> 499,36 -> 501,36 -> 501,33 -> 501,36 -> 503,36 -> 503,27 -> 503,36 -> 505,36 -> 505,28 -> 505,36 -> 507,36 -> 507,35 -> 507,36\n556,151 -> 556,153 -> 548,153 -> 548,157 -> 561,157 -> 561,153 -> 560,153 -> 560,151\n557,83 -> 557,85 -> 550,85 -> 550,89 -> 569,89 -> 569,85 -> 561,85 -> 561,83\n496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,16 -> 498,23 -> 500,23 -> 500,17 -> 500,23 -> 502,23 -> 502,16 -> 502,23\n567,146 -> 571,146\n531,65 -> 536,65\n528,62 -> 533,62\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n574,133 -> 574,137 -> 567,137 -> 567,141 -> 584,141 -> 584,137 -> 576,137 -> 576,133\n568,95 -> 571,95 -> 571,94\n497,36 -> 497,30 -> 497,36 -> 499,36 -> 499,27 -> 499,36 -> 501,36 -> 501,33 -> 501,36 -> 503,36 -> 503,27 -> 503,36 -> 505,36 -> 505,28 -> 505,36 -> 507,36 -> 507,35 -> 507,36\n497,36 -> 497,30 -> 497,36 -> 499,36 -> 499,27 -> 499,36 -> 501,36 -> 501,33 -> 501,36 -> 503,36 -> 503,27 -> 503,36 -> 505,36 -> 505,28 -> 505,36 -> 507,36 -> 507,35 -> 507,36\n497,36 -> 497,30 -> 497,36 -> 499,36 -> 499,27 -> 499,36 -> 501,36 -> 501,33 -> 501,36 -> 503,36 -> 503,27 -> 503,36 -> 505,36 -> 505,28 -> 505,36 -> 507,36 -> 507,35 -> 507,36\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n557,83 -> 557,85 -> 550,85 -> 550,89 -> 569,89 -> 569,85 -> 561,85 -> 561,83\n543,72 -> 543,73 -> 554,73 -> 554,72\n506,39 -> 506,43 -> 499,43 -> 499,51 -> 514,51 -> 514,43 -> 510,43 -> 510,39\n555,115 -> 559,115\n496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,16 -> 498,23 -> 500,23 -> 500,17 -> 500,23 -> 502,23 -> 502,16 -> 502,23\n506,39 -> 506,43 -> 499,43 -> 499,51 -> 514,51 -> 514,43 -> 510,43 -> 510,39\n536,75 -> 536,76 -> 547,76 -> 547,75\n521,62 -> 526,62\n564,108 -> 564,107 -> 564,108 -> 566,108 -> 566,101 -> 566,108 -> 568,108 -> 568,100 -> 568,108\n574,133 -> 574,137 -> 567,137 -> 567,141 -> 584,141 -> 584,137 -> 576,137 -> 576,133\n516,56 -> 521,56\n564,108 -> 564,107 -> 564,108 -> 566,108 -> 566,101 -> 566,108 -> 568,108 -> 568,100 -> 568,108\n543,72 -> 543,73 -> 554,73 -> 554,72\n574,133 -> 574,137 -> 567,137 -> 567,141 -> 584,141 -> 584,137 -> 576,137 -> 576,133\n564,113 -> 568,113\n506,39 -> 506,43 -> 499,43 -> 499,51 -> 514,51 -> 514,43 -> 510,43 -> 510,39\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,16 -> 498,23 -> 500,23 -> 500,17 -> 500,23 -> 502,23 -> 502,16 -> 502,23\n557,83 -> 557,85 -> 550,85 -> 550,89 -> 569,89 -> 569,85 -> 561,85 -> 561,83\n558,113 -> 562,113\n497,36 -> 497,30 -> 497,36 -> 499,36 -> 499,27 -> 499,36 -> 501,36 -> 501,33 -> 501,36 -> 503,36 -> 503,27 -> 503,36 -> 505,36 -> 505,28 -> 505,36 -> 507,36 -> 507,35 -> 507,36\n506,39 -> 506,43 -> 499,43 -> 499,51 -> 514,51 -> 514,43 -> 510,43 -> 510,39\n497,36 -> 497,30 -> 497,36 -> 499,36 -> 499,27 -> 499,36 -> 501,36 -> 501,33 -> 501,36 -> 503,36 -> 503,27 -> 503,36 -> 505,36 -> 505,28 -> 505,36 -> 507,36 -> 507,35 -> 507,36\n568,95 -> 571,95 -> 571,94\n497,36 -> 497,30 -> 497,36 -> 499,36 -> 499,27 -> 499,36 -> 501,36 -> 501,33 -> 501,36 -> 503,36 -> 503,27 -> 503,36 -> 505,36 -> 505,28 -> 505,36 -> 507,36 -> 507,35 -> 507,36\n510,60 -> 515,60\n497,36 -> 497,30 -> 497,36 -> 499,36 -> 499,27 -> 499,36 -> 501,36 -> 501,33 -> 501,36 -> 503,36 -> 503,27 -> 503,36 -> 505,36 -> 505,28 -> 505,36 -> 507,36 -> 507,35 -> 507,36\n557,83 -> 557,85 -> 550,85 -> 550,89 -> 569,89 -> 569,85 -> 561,85 -> 561,83\n570,117 -> 574,117\n497,36 -> 497,30 -> 497,36 -> 499,36 -> 499,27 -> 499,36 -> 501,36 -> 501,33 -> 501,36 -> 503,36 -> 503,27 -> 503,36 -> 505,36 -> 505,28 -> 505,36 -> 507,36 -> 507,35 -> 507,36\n507,62 -> 512,62\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n556,151 -> 556,153 -> 548,153 -> 548,157 -> 561,157 -> 561,153 -> 560,153 -> 560,151\n564,108 -> 564,107 -> 564,108 -> 566,108 -> 566,101 -> 566,108 -> 568,108 -> 568,100 -> 568,108\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n506,39 -> 506,43 -> 499,43 -> 499,51 -> 514,51 -> 514,43 -> 510,43 -> 510,39\n564,108 -> 564,107 -> 564,108 -> 566,108 -> 566,101 -> 566,108 -> 568,108 -> 568,100 -> 568,108\n497,36 -> 497,30 -> 497,36 -> 499,36 -> 499,27 -> 499,36 -> 501,36 -> 501,33 -> 501,36 -> 503,36 -> 503,27 -> 503,36 -> 505,36 -> 505,28 -> 505,36 -> 507,36 -> 507,35 -> 507,36\n561,111 -> 565,111\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,16 -> 498,23 -> 500,23 -> 500,17 -> 500,23 -> 502,23 -> 502,16 -> 502,23\n558,148 -> 562,148\n513,58 -> 518,58\n564,108 -> 564,107 -> 564,108 -> 566,108 -> 566,101 -> 566,108 -> 568,108 -> 568,100 -> 568,108\n558,117 -> 562,117\n557,83 -> 557,85 -> 550,85 -> 550,89 -> 569,89 -> 569,85 -> 561,85 -> 561,83\n546,79 -> 546,80 -> 558,80\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n536,75 -> 536,76 -> 547,76 -> 547,75\n500,62 -> 505,62\n506,39 -> 506,43 -> 499,43 -> 499,51 -> 514,51 -> 514,43 -> 510,43 -> 510,39\n556,151 -> 556,153 -> 548,153 -> 548,157 -> 561,157 -> 561,153 -> 560,153 -> 560,151\n520,58 -> 525,58\n535,67 -> 540,67\n574,133 -> 574,137 -> 567,137 -> 567,141 -> 584,141 -> 584,137 -> 576,137 -> 576,133\n497,36 -> 497,30 -> 497,36 -> 499,36 -> 499,27 -> 499,36 -> 501,36 -> 501,33 -> 501,36 -> 503,36 -> 503,27 -> 503,36 -> 505,36 -> 505,28 -> 505,36 -> 507,36 -> 507,35 -> 507,36\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n546,79 -> 546,80 -> 558,80\n564,108 -> 564,107 -> 564,108 -> 566,108 -> 566,101 -> 566,108 -> 568,108 -> 568,100 -> 568,108\n543,72 -> 543,73 -> 554,73 -> 554,72\n564,117 -> 568,117\n497,36 -> 497,30 -> 497,36 -> 499,36 -> 499,27 -> 499,36 -> 501,36 -> 501,33 -> 501,36 -> 503,36 -> 503,27 -> 503,36 -> 505,36 -> 505,28 -> 505,36 -> 507,36 -> 507,35 -> 507,36\n497,36 -> 497,30 -> 497,36 -> 499,36 -> 499,27 -> 499,36 -> 501,36 -> 501,33 -> 501,36 -> 503,36 -> 503,27 -> 503,36 -> 505,36 -> 505,28 -> 505,36 -> 507,36 -> 507,35 -> 507,36\n536,75 -> 536,76 -> 547,76 -> 547,75\n557,83 -> 557,85 -> 550,85 -> 550,89 -> 569,89 -> 569,85 -> 561,85 -> 561,83\n496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,16 -> 498,23 -> 500,23 -> 500,17 -> 500,23 -> 502,23 -> 502,16 -> 502,23\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n539,69 -> 544,69\n552,117 -> 556,117\n556,151 -> 556,153 -> 548,153 -> 548,157 -> 561,157 -> 561,153 -> 560,153 -> 560,151\n496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,16 -> 498,23 -> 500,23 -> 500,17 -> 500,23 -> 502,23 -> 502,16 -> 502,23\n561,146 -> 565,146\n570,148 -> 574,148\n496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,16 -> 498,23 -> 500,23 -> 500,17 -> 500,23 -> 502,23 -> 502,16 -> 502,23\n496,23 -> 496,16 -> 496,23 -> 498,23 -> 498,16 -> 498,23 -> 500,23 -> 500,17 -> 500,23 -> 502,23 -> 502,16 -> 502,23\n532,69 -> 537,69\n564,108 -> 564,107 -> 564,108 -> 566,108 -> 566,101 -> 566,108 -> 568,108 -> 568,100 -> 568,108\n512,54 -> 517,54\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n517,60 -> 522,60\n564,148 -> 568,148\n506,58 -> 511,58\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130\n541,130 -> 541,122 -> 541,130 -> 543,130 -> 543,123 -> 543,130 -> 545,130 -> 545,124 -> 545,130 -> 547,130 -> 547,122 -> 547,130 -> 549,130 -> 549,120 -> 549,130 -> 551,130 -> 551,121 -> 551,130 -> 553,130 -> 553,128 -> 553,130 -> 555,130 -> 555,128 -> 555,130 -> 557,130 -> 557,126 -> 557,130 -> 559,130 -> 559,125 -> 559,130`

const simulate = (input, floor = false) => {
    const coords = input.split("\n").map((x) =>x.split(" -> ").map((y) => y.split(",").map(Number)))
	
	const xC = coords.map(x=>x.map(y=>y[0])).flat(Infinity)
	const yC = coords.map(x=>x.map(y=>y[1])).flat(Infinity)

	let minX = Math.min(...xC)
	let maxX = Math.max(...xC)
	let maxY = Math.max(...yC)

	if (floor) {
		minX = Math.min(500 - (maxY + 3), minX - maxY + 3);
		maxX = Math.max(500 + (maxY + 3), maxY + 3 - maxX);
		maxY += 2;
	}

	let plane = {};

	for (x = minX; x <= maxX; x++){
		for (y = 0; y <= maxY; y++) {
            plane[`${x},${y}`] = "."
        }
    }

	coords.forEach((rocks) => {
		for (let l = 1; l < rocks.length; l++) {
			let here = rocks[l],
				last = rocks[l - 1],
				gmod = (a) => (last[a] < here[a] ? 1 : last[a] > here[a] ? -1 : 0);

			for (let x = last[0]; x !== here[0] + gmod(0); x += gmod(0))
				plane[`${x},${here[1]}`] = "#";

			for (let y = last[1]; y !== here[1] + gmod(1); y += gmod(1))
				plane[`${here[0]},${y}`] = "#";
		}
	});

	plane["500,0"] = "+";

	if (floor) for (let x = minX; x <= maxX; x++) plane[`${x},${maxY}`] = "#";

	let sand = 0;

	while (true) {
		let x = 500,
			y = 0;

		let sq = (a, b) => plane[`${a},${b}`];

		while (sq(x, y + 1)) {
			plane[`${x},${y}`] = ".";

			if (sq(x, y + 1) === ".") y += 1;
			else if (!"o#".includes(sq(x - 1, y + 1))) {
				x -= 1;
				y += 1;
			} else if (!"o#".includes(sq(x + 1, y + 1))) {
				x += 1;
				y += 1;
			} else {
				plane[`${x},${y}`] = "o";
				if (floor && x === 500 && y === 0) return ++sand;
				break;
			}

			if (!sq(x, y + 1)) return sand;
		}

		sand++;
	}
};

console.log(simulate(input)); // Part 1

console.log(simulate(input, true)); // Part 2